# Getting started with Avro
This exemple explain how to get started with Avro.


## Avro Primer
There is 2 methods to describe entites using Avro:
1. Using the **Avro JSON** format (as demonstrated in their Getting started)
2. or Using the **Avro IDL** format (*Interface Definition Language*)

This example uses the **Avro IDL** format as it is more concise, and its syntax is less prone to human errors.


## Generating Java classes from Avro files
The Avro IDL files have the `.avdl` extension and are located in the `src/main/avro/` folder. It contains 3 files:
- `exemple.avdl` : Basic example
- `dat-file.avdl` : Data structures for the .DAT Affymetrix data format. It contains 4 record types:
  - `Dat_v1` : For files generated by the MAS and GCOS 1.x software.
  - `Dat_cc` : For files generated by the Command Console software.
  - `Point` : Used by `Dat_v1`.
  - `PointCC` : Used by `GridCC`.
  - `GridCC` : Used by `Dat_CC`.
- `cel-file.avdl` : _To be continued ..._

The `.avdl` files need to be converted to JSON first (Avro's native format), and then compiled into Java classes. This step is already setup in the Maven configuration file (`pom.xml`).

So to generate the Java classes into `src/main/java/`, run the Maven command:
```bash
mvn clean compile
```


## Generating UML diagrams from Avro files (using Doxygen)
See file doxygen-notes.md


## Writing to disk using Avro IDL
TODO


## Reading from disk using Avro IDL
TODO


## Avro Summary
- Avro Documentation: http://avro.apache.org/docs/current/
- Avro Getting started (Java): http://avro.apache.org/docs/current/gettingstartedjava.html
- Avro Specification: http://avro.apache.org/docs/current/spec.html
- Avro Interface Definition Language: http://avro.apache.org/docs/current/idl.html
- Avro Quick Start: https://github.com/phunt/avro-rpc-quickstart
- Avro Wiki: https://cwiki.apache.org/confluence/display/AVRO/Index


### Avro Data Types

An Avro file has a schema, and all objects stored in the file must be written according to that schema, using binary encoding. **Objects are stored in blocks that may be compressed**. Syncronization markers are used between blocks to permit efficient splitting of files for MapReduce processing.

Compression codecs: null (uncompressed), deflate (gzip), snappy.


| Java Type         | Avro Type | JSON Type           | Avro Description |
| ----------------- | --------- | ------------------- | ----------- |
|                   | null      | null                | No value (used for optional values). |
| Boolean           | boolean   | boolean (`true`)    | Binary value |
| Integer           | int       | integer             | 32-bit signed integer |
| Long              | long      | integer             | 64-bit signed integer |
| Float             | float     | number              | Single precision IEEE 754 floating-point number |
| Double            | double    | number              | Double precision IEEE 754 floating-point number |
| ByteBuffer        | bytes     | string (`"\u00FF"`) | Sequence of 8-bit unsigned bytes |
| CharSequence      | string    | string (`"foo"`)    | Unicode character sequence |
| GenericRecord     | record    | object (`{"a": 1}`) |  |
| GenericEnumSymbol | enum      | string (`"FOO"`)    | A fixed list of symbols |
| org.acme.Foo[]    | array     | array (`[a]`)       | A list of items of the same type (e.g. `{"type": "array", "java-element": "org.acme.Foo"}`) |
| Collection        | array     | array (`[a]`)       | A list of items of the same type (e.g. `{"type": "array", "java-class": "java.util.ArrayList"}`) |
| Map               | maps      | object (`{"a": 1}`) | A Key-Value list of items of the same value type. |
|                   | unions    |                     | Combine multiple possible data types |
| GenericFixed      | fixed     | string (`"\u00ff"`) | A fixed-size list of bytes |
| BigDecimal        | string    | string              | e.g. `{"type": "string", "java-class": "java.math.BigDecimal"}` |
| BigInteger        | string    | string              | e.g. `{"type": "string", "java-class": "java.math.BigInteger"}` |
| URI, URL, File    | string    | string              | idem |

